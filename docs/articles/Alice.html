<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Semantic Librarian for any text (Alice in wonderland) • RsemanticLibrarian</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Semantic Librarian for any text (Alice in wonderland)">
<meta property="og:description" content="">
<meta property="og:image" content="https://crumplab.github.io/RsemanticLibrarian/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RsemanticLibrarian</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Alice.html">Semantic Librarian for any text (Alice in wonderland)</a>
    </li>
    <li>
      <a href="../articles/SL_bib.html">Semantic Librarian for bib files</a>
    </li>
    <li>
      <a href="../articles/Semantic_Librarian_Tutorial.html">Semantic Librarian Tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CrumpLab/RsemanticLibrarian">
    <span class="fa fa-lg fa-github"></span>
     
    source code
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Semantic Librarian for any text (Alice in wonderland)</h1>
            
      
      
      <div class="hidden name"><code>Alice.Rmd</code></div>

    </div>

    
    
<p>A more general goal of Semantic Librarian is to create functions that can vectorize any kind of text corpus, and produce semantic vectors at the level of words, and any additional factor that is desired.</p>
<p>For example, previous Semantic Librarian’s have been deployed on scientific abstracts, and the functions were written to create word vectors, abstract vectors, and author vectors. A single abstract vector is formed by summing all of the word vectors contained in the abstract. A single author vector is formed by summing all of the abstract vector for that author.</p>
<p>The more general notion is that a series of texts (e.g., like abstracts) can be vectorized at a minimum to produce vectors for each word. Once the word vectors are obtained, additional vectors can be formed for any factor by addition. For example, if we consider author name to be a factor, then an author vector would be the sum of the word vectors used by that author.</p>
<p>The figure below displays the very general notion, which is to have a dataframe including one column for each unit of text (e.g., a sentence or a paragraph), and additional factor columns that describe attributes of the text (e.g., the author, year, or any additional attribute).</p>
<p>Then, it would be wonderful to have some functions that would create the entire vector space (e.g., words, and factors), and then pump the vector space into a Shiny app for search and visualization.</p>
<p><img src="sl_goals.png" width="50%"></p>
<div id="alice-in-wonderland" class="section level2">
<h2 class="hasAnchor">
<a href="#alice-in-wonderland" class="anchor"></a>Alice in wonderland</h2>
<p>The Alice in wonderland is a minimal example for solving the above problem.</p>
<p>The source code is available in this repository:</p>
<p><a href="https://github.com/CrumpLab/alice" class="uri">https://github.com/CrumpLab/alice</a></p>
<p>The Shiny App that is produced can be viewed here:</p>
<p><a href="https://semanticlibrarian.shinyapps.io/alice/" class="uri">https://semanticlibrarian.shinyapps.io/alice/</a></p>
<p>The remaining tutorial explains the major components of the alice example.</p>
</div>
<div id="alice-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#alice-overview" class="anchor"></a>Alice overview</h2>
<p>The text for Alice in Wonderland is in <code>datafiles/alice.txt</code>. The <code>corpus_constructor.R</code> file loads in the text and produces the vector space, which is stored in <code>sl_data.RData</code> as a list. The shiny app <code>app.R</code> loads the vector space and allows search and display of similarity between items in the same or different vector space.</p>
<div id="current-limitations" class="section level3">
<h3 class="hasAnchor">
<a href="#current-limitations" class="anchor"></a>Current limitations</h3>
<p>Although the intention behind this example is to show how any text corpus could be vectorized and loaded into a Shiny app, there are some limitations. For example, the text for alice and wonderland was itemized at the sentence level. As a result, each row in the dataframe is a sentence, with periods removed. Some of the functions for rendering the vectors were written to handle this particular case. As a result, the example will not work as intended if the rows of text contain larger units, such as paragraphs with periods. These kinds of issues will be addressed in future versions.</p>
</div>
<div id="corpus_constructor" class="section level3">
<h3 class="hasAnchor">
<a href="#corpus_constructor" class="anchor"></a>corpus_constructor</h3>
<p>Below is a walk through of the code to create the Alice and Wonderland vector space. Step 1 is to load libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(RsemanticLibrarian)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(data.table)</span></code></pre></div>
<p>The text source is loaded and converted into sentences. The <code>breakdown</code> function from the <code>LSAfun</code> package is used to clean the text a bit, and convert to lowercase. A bit of further cleaning is done by <code>rm_endmark</code> from the <code>qdapRegex</code>. In general, text sources are fickle, and cleaning them properly can take time and effort. The goal is to produce lower case words, with special characters removed, and periods as sentence markers.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># Load text</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>alice &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/scan">scan</a></span>(<span class="dt">file=</span><span class="st">"datafiles/Alice.txt"</span>, <span class="dt">what=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">character</a></span>())</span>
<span id="cb2-4"><a href="#cb2-4"></a>alice &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(alice, <span class="dt">sep=</span><span class="st">" "</span>, <span class="dt">collapse=</span><span class="st">" "</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>alice &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/tstrsplit">strsplit</a></span>(alice,<span class="dt">split=</span><span class="st">"[.]"</span>))</span>
<span id="cb2-6"><a href="#cb2-6"></a>alice &lt;-<span class="st"> </span>LSAfun<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/LSAfun/topics/breakdown">breakdown</a></span>(alice)</span>
<span id="cb2-7"><a href="#cb2-7"></a>alice &lt;-<span class="st"> </span>qdapRegex<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/qdapRegex/topics/rm_endmark">rm_endmark</a></span>(alice)</span></code></pre></div>
<p>A dataframe is created with a column for the sentences, and three additional arbitrary factor columns.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co"># Make tidystyle dataframe (text,  factor columns, index added for convenience)</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>text_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/data.table">data.table</a></span>(<span class="dt">sentences =</span> alice,</span>
<span id="cb3-4"><a href="#cb3-4"></a>                      <span class="dt">index=</span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(alice),</span>
<span id="cb3-5"><a href="#cb3-5"></a>                      <span class="dt">factor1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(letters,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(alice)),</span>
<span id="cb3-6"><a href="#cb3-6"></a>                      <span class="dt">factor2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(letters,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(alice)),</span>
<span id="cb3-7"><a href="#cb3-7"></a>                      <span class="dt">factor3 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(letters,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(alice))</span>
<span id="cb3-8"><a href="#cb3-8"></a>)</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a>text_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(text_df)</span></code></pre></div>
<p>Below three functions are defined that are customized from this example. These functions are not in RsemanticLibrarian, but they are modified from existing functions in RsemanticLibrarian.</p>
<p><code>sl_clean_vector2</code> does additional cleaning of the text.</p>
<p><code>factor_vectors</code> creates vectors for each each level of each factor. The resultant vectors are the sum of the words that occured for each factor level.</p>
<p><code>sl_semantic_general</code> is a wrapper function with some customization and some calls to RsemanticLibrarian. It runs the entire process of creating all semantic vectors.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Define a few functions</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># deals with sentences that have no periods</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>sl_clean_vector2 &lt;-<span class="st"> </span><span class="cf">function</span>(words){</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(words,sl_clean))</span>
<span id="cb4-6"><a href="#cb4-6"></a>}</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># create vectors for each factor</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>factor_vectors &lt;-<span class="st"> </span><span class="cf">function</span>(at_list,</span>
<span id="cb4-10"><a href="#cb4-10"></a>                           <span class="dt">articles =</span> article_df,</span>
<span id="cb4-11"><a href="#cb4-11"></a>                           <span class="dt">fct =</span> the_factor,</span>
<span id="cb4-12"><a href="#cb4-12"></a>                           <span class="dt">a_vectors =</span> article_vectors) {</span>
<span id="cb4-13"><a href="#cb4-13"></a>  author_vectors &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>, <span class="dt">ncol =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(a_vectors)[<span class="dv">2</span>], <span class="dt">nrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(at_list))</span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(at_list)){</span>
<span id="cb4-15"><a href="#cb4-15"></a>    <span class="co">#auth_ids &lt;- which(articles$authorlist %in% at_list[i])</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>    auth_ids &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(articles[,fct],at_list[i]))</span>
<span id="cb4-17"><a href="#cb4-17"></a>    </span>
<span id="cb4-18"><a href="#cb4-18"></a>    <span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(auth_ids) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb4-19"><a href="#cb4-19"></a>      author_vectors[i,] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">colSums</a></span>(a_vectors[auth_ids,])</span>
<span id="cb4-20"><a href="#cb4-20"></a>    } <span class="cf">else</span> {</span>
<span id="cb4-21"><a href="#cb4-21"></a>      author_vectors[i,] &lt;-<span class="st"> </span>a_vectors[auth_ids,]</span>
<span id="cb4-22"><a href="#cb4-22"></a>    }</span>
<span id="cb4-23"><a href="#cb4-23"></a>  }</span>
<span id="cb4-24"><a href="#cb4-24"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(author_vectors)</span>
<span id="cb4-25"><a href="#cb4-25"></a>}</span>
<span id="cb4-26"><a href="#cb4-26"></a></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="co"># generate all vectors, return sl_data list</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>sl_semantic_general &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">abstract_df=</span>text_df,</span>
<span id="cb4-29"><a href="#cb4-29"></a>         <span class="dt">text_column =</span> <span class="st">"sentences"</span>,</span>
<span id="cb4-30"><a href="#cb4-30"></a>         factor_columns,</span>
<span id="cb4-31"><a href="#cb4-31"></a>         <span class="dt">riv_param =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>,<span class="dv">6</span>)){</span>
<span id="cb4-32"><a href="#cb4-32"></a>  </span>
<span id="cb4-33"><a href="#cb4-33"></a>  vector_corpus &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>()</span>
<span id="cb4-34"><a href="#cb4-34"></a>  </span>
<span id="cb4-35"><a href="#cb4-35"></a>  <span class="co"># create corpus dictionary</span></span>
<span id="cb4-36"><a href="#cb4-36"></a>  vector_corpus[[<span class="st">'word_terms'</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sl_corpus_dictionary.html">sl_corpus_dictionary</a></span>(</span>
<span id="cb4-37"><a href="#cb4-37"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(abstract_df[,text_column], <span class="dt">use.names=</span><span class="ot">FALSE</span>)</span>
<span id="cb4-38"><a href="#cb4-38"></a>  )</span>
<span id="cb4-39"><a href="#cb4-39"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">message</a></span>(<span class="st">"Semantic Librarian: corpus dictionary created..."</span>)</span>
<span id="cb4-40"><a href="#cb4-40"></a>  </span>
<span id="cb4-41"><a href="#cb4-41"></a>  <span class="co"># convert to sentences, clean</span></span>
<span id="cb4-42"><a href="#cb4-42"></a>  clean_sentences &lt;-<span class="st"> </span><span class="kw">sl_clean_vector2</span>(</span>
<span id="cb4-43"><a href="#cb4-43"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(abstract_df[,text_column], <span class="dt">use.names=</span><span class="ot">FALSE</span>)</span>
<span id="cb4-44"><a href="#cb4-44"></a>  )</span>
<span id="cb4-45"><a href="#cb4-45"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">message</a></span>(<span class="st">"Semantic Librarian: Cleaned sentences..."</span>)</span>
<span id="cb4-46"><a href="#cb4-46"></a>  </span>
<span id="cb4-47"><a href="#cb4-47"></a>  <span class="co"># word ids for sentences</span></span>
<span id="cb4-48"><a href="#cb4-48"></a>  sentence_ids &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sl_word_ids_sentences.html">sl_word_ids_sentences</a></span>(clean_sentences,vector_corpus[[<span class="st">'word_terms'</span>]])</span>
<span id="cb4-49"><a href="#cb4-49"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">message</a></span>(<span class="st">"Semantic Librarian: Created word IDs for sentences..."</span>)</span>
<span id="cb4-50"><a href="#cb4-50"></a>  </span>
<span id="cb4-51"><a href="#cb4-51"></a>  <span class="co"># Create word vectors</span></span>
<span id="cb4-52"><a href="#cb4-52"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">message</a></span>(<span class="st">"Semantic Librarian: Creating BEAGLE word vectors..."</span>)</span>
<span id="cb4-53"><a href="#cb4-53"></a>  vector_corpus[[<span class="st">'word_vectors'</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sl_beagle_vectors.html">sl_beagle_vectors</a></span>(<span class="dt">s_ids =</span> sentence_ids,</span>
<span id="cb4-54"><a href="#cb4-54"></a>                                    <span class="dt">dictionary =</span> vector_corpus[[<span class="st">'word_terms'</span>]],</span>
<span id="cb4-55"><a href="#cb4-55"></a>                                    <span class="dt">riv =</span> riv_param,</span>
<span id="cb4-56"><a href="#cb4-56"></a>                                     <span class="dt">verbose =</span> <span class="dv">500</span>)</span>
<span id="cb4-57"><a href="#cb4-57"></a>  </span>
<span id="cb4-58"><a href="#cb4-58"></a>  <span class="co"># get text vectors</span></span>
<span id="cb4-59"><a href="#cb4-59"></a>  the_abstracts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>()</span>
<span id="cb4-60"><a href="#cb4-60"></a>  the_abstracts[[<span class="st">'new'</span>]] &lt;-<span class="st"> </span>abstract_df[,text_column]</span>
<span id="cb4-61"><a href="#cb4-61"></a>  clean_abstracts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(the_abstracts<span class="op">$</span>new,</span>
<span id="cb4-62"><a href="#cb4-62"></a>                            sl_clean)</span>
<span id="cb4-63"><a href="#cb4-63"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">message</a></span>(<span class="st">"Semantic Librarian: cleaning text..."</span>)</span>
<span id="cb4-64"><a href="#cb4-64"></a></span>
<span id="cb4-65"><a href="#cb4-65"></a>  abstract_word_ids &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sl_word_ids_sentences.html">sl_word_ids_sentences</a></span>(clean_abstracts,vector_corpus[[<span class="st">'word_terms'</span>]])</span>
<span id="cb4-66"><a href="#cb4-66"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">message</a></span>(<span class="st">"Semantic Librarian: Making text-word IDs..."</span>)</span>
<span id="cb4-67"><a href="#cb4-67"></a></span>
<span id="cb4-68"><a href="#cb4-68"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">message</a></span>(<span class="st">"Semantic Librarian: Making text vectors..."</span>)</span>
<span id="cb4-69"><a href="#cb4-69"></a>  vector_corpus[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(text_column,<span class="st">"vectors"</span>,<span class="dt">sep=</span><span class="st">"_"</span>,<span class="dt">collapse=</span><span class="st">''</span>)]] &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sl_article_vectors.html">sl_article_vectors</a></span>(abstract_word_ids, <span class="dt">w_matrix =</span> vector_corpus[[<span class="st">'word_vectors'</span>]])</span>
<span id="cb4-70"><a href="#cb4-70"></a>  </span>
<span id="cb4-71"><a href="#cb4-71"></a>  vector_corpus[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(text_column,<span class="st">"terms"</span>,<span class="dt">sep=</span><span class="st">"_"</span>,<span class="dt">collapse=</span><span class="st">''</span>)]] &lt;-<span class="st"> </span>abstract_df[,text_column]</span>
<span id="cb4-72"><a href="#cb4-72"></a>  </span>
<span id="cb4-73"><a href="#cb4-73"></a>  <span class="co">#get factor vectors</span></span>
<span id="cb4-74"><a href="#cb4-74"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">message</a></span>(<span class="st">"Semantic Librarian: Making factor vectors..."</span>)</span>
<span id="cb4-75"><a href="#cb4-75"></a>  <span class="cf">for</span>(i <span class="cf">in</span> factor_columns){</span>
<span id="cb4-76"><a href="#cb4-76"></a>    vector_corpus[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(i,<span class="st">"terms"</span>,<span class="dt">sep=</span><span class="st">"_"</span>,<span class="dt">collapse=</span><span class="st">''</span>)]] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/duplicated">unique</a></span>(abstract_df[,i])</span>
<span id="cb4-77"><a href="#cb4-77"></a>    </span>
<span id="cb4-78"><a href="#cb4-78"></a>    vector_corpus[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(i,<span class="st">"vectors"</span>,<span class="dt">sep=</span><span class="st">"_"</span>,<span class="dt">collapse=</span><span class="st">''</span>)]] &lt;-<span class="st"> </span><span class="kw">factor_vectors</span>(<span class="dt">at_list =</span> vector_corpus[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(i,<span class="st">"terms"</span>,<span class="dt">sep=</span><span class="st">"_"</span>,<span class="dt">collapse=</span><span class="st">''</span>)]],</span>
<span id="cb4-79"><a href="#cb4-79"></a>                                        <span class="dt">articles =</span> abstract_df,</span>
<span id="cb4-80"><a href="#cb4-80"></a>                                        <span class="dt">fct =</span> i,</span>
<span id="cb4-81"><a href="#cb4-81"></a>                                        <span class="dt">a_vectors =</span> vector_corpus[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(text_column,<span class="st">"vectors"</span>,<span class="dt">sep=</span><span class="st">"_"</span>,<span class="dt">collapse=</span><span class="st">''</span>)]])</span>
<span id="cb4-82"><a href="#cb4-82"></a>  }</span>
<span id="cb4-83"><a href="#cb4-83"></a>  </span>
<span id="cb4-84"><a href="#cb4-84"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">message</a></span>(<span class="st">"Semantic Librarian: Corpus Complete"</span>)</span>
<span id="cb4-85"><a href="#cb4-85"></a> </span>
<span id="cb4-86"><a href="#cb4-86"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(vector_corpus)</span>
<span id="cb4-87"><a href="#cb4-87"></a></span>
<span id="cb4-88"><a href="#cb4-88"></a>}</span></code></pre></div>
<p>Now we run the function to create the vector space and save the vector data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># run the function, save the data</span></span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>sl_data &lt;-<span class="st"> </span><span class="kw">sl_semantic_general</span>(<span class="dt">abstract_df =</span> text_df,</span>
<span id="cb5-5"><a href="#cb5-5"></a>                               <span class="dt">text_column =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"sentences"</span>),</span>
<span id="cb5-6"><a href="#cb5-6"></a>                               <span class="dt">factor_columns =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"factor1"</span>,<span class="st">"factor2"</span>),</span>
<span id="cb5-7"><a href="#cb5-7"></a>                               <span class="dt">riv_param =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>,<span class="dv">6</span>))</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a>sl_data[[<span class="st">'text_df'</span>]] &lt;-<span class="st"> </span>text_df</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/save">save</a></span>(sl_data, <span class="dt">file=</span><span class="st">"sl_data.RData"</span>)</span></code></pre></div>
</div>
<div id="shiny-app-r" class="section level3">
<h3 class="hasAnchor">
<a href="#shiny-app-r" class="anchor"></a>Shiny app.r</h3>
<p>The contents of the data file <code>sl_data.RData</code> are then loaded into this Shiny app. This tutorial is limited in scope and does not detail each aspect of the Shiny code.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># minimal example for creating a semantic librarian</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># corpus: Alice and Wonderland</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># author: Matt Crump</span></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># load data #####</span></span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/load">load</a></span>(<span class="dt">file =</span> <span class="st">"sl_data.RData"</span>, <span class="dt">envir=</span>.GlobalEnv)</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co"># load libraries #####</span></span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)</span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shinyjs)</span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(lsa)</span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(LSAfun)</span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(DT)</span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(Rcpp)</span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggrepel)</span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rvest)</span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(stringr)</span>
<span id="cb6-22"><a href="#cb6-22"></a></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">## load functions ####</span></span>
<span id="cb6-24"><a href="#cb6-24"></a></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/source">source</a></span>(<span class="st">"functions/semanticL.R"</span>)</span>
<span id="cb6-26"><a href="#cb6-26"></a></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="st">`</span><span class="dt">%then%</span><span class="st">`</span> &lt;-<span class="st"> </span>shiny<span class="op">:::</span><span class="st">`</span><span class="dt">%OR%</span><span class="st">`</span></span>
<span id="cb6-28"><a href="#cb6-28"></a></span>
<span id="cb6-29"><a href="#cb6-29"></a><span class="co"># define UI ####</span></span>
<span id="cb6-30"><a href="#cb6-30"></a>ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(</span>
<span id="cb6-31"><a href="#cb6-31"></a></span>
<span id="cb6-32"><a href="#cb6-32"></a>    <span class="co"># Application title</span></span>
<span id="cb6-33"><a href="#cb6-33"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/titlePanel">titlePanel</a></span>(<span class="st">"Search Alice"</span>),</span>
<span id="cb6-34"><a href="#cb6-34"></a></span>
<span id="cb6-35"><a href="#cb6-35"></a>    <span class="co"># Sidebar to choose vector spaces</span></span>
<span id="cb6-36"><a href="#cb6-36"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/sidebarLayout">sidebarLayout</a></span>(</span>
<span id="cb6-37"><a href="#cb6-37"></a>        <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/sidebarLayout">sidebarPanel</a></span>(</span>
<span id="cb6-38"><a href="#cb6-38"></a>            <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/selectInput">selectInput</a></span>(<span class="st">"search_vectors"</span>, <span class="dt">label =</span> <span class="st">"Search Vector Space"</span>, </span>
<span id="cb6-39"><a href="#cb6-39"></a>                        <span class="dt">choices =</span> <span class="ot">NULL</span>),</span>
<span id="cb6-40"><a href="#cb6-40"></a>            <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/selectInput">selectInput</a></span>(<span class="st">"target_vectors"</span>, <span class="dt">label =</span> <span class="st">"Target Vector Space"</span>, </span>
<span id="cb6-41"><a href="#cb6-41"></a>                        <span class="dt">choices =</span> <span class="ot">NULL</span>),</span>
<span id="cb6-42"><a href="#cb6-42"></a>            <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/selectInput">selectInput</a></span>(<span class="st">"search_terms"</span>, <span class="dt">label =</span> <span class="st">"Search terms"</span>, </span>
<span id="cb6-43"><a href="#cb6-43"></a>                        <span class="dt">choices =</span> <span class="ot">NULL</span>),</span>
<span id="cb6-44"><a href="#cb6-44"></a>            <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/sliderInput">sliderInput</a></span>(<span class="st">"num_items"</span>, <span class="dt">label =</span> <span class="st">"number of items"</span>, <span class="dt">min =</span> <span class="dv">5</span>, </span>
<span id="cb6-45"><a href="#cb6-45"></a>                        <span class="dt">max =</span> <span class="dv">30</span>, <span class="dt">value =</span> <span class="dv">10</span>, <span class="dt">step=</span><span class="dv">1</span>),</span>
<span id="cb6-46"><a href="#cb6-46"></a>            <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/sliderInput">sliderInput</a></span>(<span class="st">"num_clusters"</span>, <span class="dt">label =</span> <span class="st">"number of clusters"</span>, <span class="dt">min =</span> <span class="dv">1</span>, </span>
<span id="cb6-47"><a href="#cb6-47"></a>                        <span class="dt">max =</span> <span class="dv">4</span>, <span class="dt">value =</span> <span class="dv">2</span>, <span class="dt">step=</span><span class="dv">1</span>)</span>
<span id="cb6-48"><a href="#cb6-48"></a>        ),</span>
<span id="cb6-49"><a href="#cb6-49"></a></span>
<span id="cb6-50"><a href="#cb6-50"></a>    <span class="co"># Main panel for plot and table</span></span>
<span id="cb6-51"><a href="#cb6-51"></a>        <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/sidebarLayout">mainPanel</a></span>(</span>
<span id="cb6-52"><a href="#cb6-52"></a>           <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/plotOutput">plotOutput</a></span>(<span class="st">"sl_plot"</span>),</span>
<span id="cb6-53"><a href="#cb6-53"></a>           DT<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DT/topics/dataTableOutput">dataTableOutput</a></span>(<span class="st">"sl_table"</span>)</span>
<span id="cb6-54"><a href="#cb6-54"></a>        )</span>
<span id="cb6-55"><a href="#cb6-55"></a>    )</span>
<span id="cb6-56"><a href="#cb6-56"></a>)</span>
<span id="cb6-57"><a href="#cb6-57"></a></span>
<span id="cb6-58"><a href="#cb6-58"></a><span class="co"># define server ####</span></span>
<span id="cb6-59"><a href="#cb6-59"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</span>
<span id="cb6-60"><a href="#cb6-60"></a>    </span>
<span id="cb6-61"><a href="#cb6-61"></a>    <span class="co">## Initialize Reactive variables ####</span></span>
<span id="cb6-62"><a href="#cb6-62"></a>    values &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/reactiveValues">reactiveValues</a></span>()</span>
<span id="cb6-63"><a href="#cb6-63"></a>    </span>
<span id="cb6-64"><a href="#cb6-64"></a>    <span class="co"># Update and populate vector selection options ####</span></span>
<span id="cb6-65"><a href="#cb6-65"></a>    </span>
<span id="cb6-66"><a href="#cb6-66"></a>    sl_data_names &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(sl_data)</span>
<span id="cb6-67"><a href="#cb6-67"></a>    vector_spaces &lt;-<span class="st"> </span>sl_data_names[<span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(sl_data),<span class="st">"_vector"</span>)]</span>
<span id="cb6-68"><a href="#cb6-68"></a>    vector_terms &lt;-<span class="st"> </span>sl_data_names[<span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(sl_data),<span class="st">"_terms"</span>)]</span>
<span id="cb6-69"><a href="#cb6-69"></a>    </span>
<span id="cb6-70"><a href="#cb6-70"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/updateSelectInput">updateSelectizeInput</a></span>(session,<span class="st">'search_vectors'</span>, <span class="dt">label =</span> <span class="st">"Search Vector Space"</span>,</span>
<span id="cb6-71"><a href="#cb6-71"></a>                         <span class="dt">choices =</span> vector_spaces)</span>
<span id="cb6-72"><a href="#cb6-72"></a>    </span>
<span id="cb6-73"><a href="#cb6-73"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/updateSelectInput">updateSelectizeInput</a></span>(session,<span class="st">'target_vectors'</span>, <span class="dt">label =</span> <span class="st">"Target Vector Space"</span>,</span>
<span id="cb6-74"><a href="#cb6-74"></a>                         <span class="dt">choices =</span> vector_spaces)</span>
<span id="cb6-75"><a href="#cb6-75"></a>    </span>
<span id="cb6-76"><a href="#cb6-76"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/observeEvent">observeEvent</a></span>(input<span class="op">$</span>search_vectors,{</span>
<span id="cb6-77"><a href="#cb6-77"></a>        splitter &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/tstrsplit">strsplit</a></span>(input<span class="op">$</span>search_vectors,<span class="dt">split=</span><span class="st">"_"</span>))</span>
<span id="cb6-78"><a href="#cb6-78"></a>        values<span class="op">$</span>term_choice &lt;-<span class="st"> </span>sl_data_names[<span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(sl_data),</span>
<span id="cb6-79"><a href="#cb6-79"></a>                                                <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(splitter[<span class="dv">1</span>],<span class="st">"_terms"</span>,<span class="dt">sep=</span><span class="st">""</span>,<span class="dt">collapse=</span><span class="st">''</span>))]</span>
<span id="cb6-80"><a href="#cb6-80"></a>        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(values<span class="op">$</span>term_choice)</span>
<span id="cb6-81"><a href="#cb6-81"></a>        </span>
<span id="cb6-82"><a href="#cb6-82"></a>        <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/updateSelectInput">updateSelectizeInput</a></span>(session,<span class="st">'search_terms'</span>, <span class="dt">label =</span> <span class="st">"Search Terms"</span>,</span>
<span id="cb6-83"><a href="#cb6-83"></a>                             <span class="dt">choices =</span> sl_data[values<span class="op">$</span>term_choice], <span class="dt">selected=</span>sl_data[values<span class="op">$</span>term_choice][<span class="dv">1</span>])</span>
<span id="cb6-84"><a href="#cb6-84"></a>    })</span>
<span id="cb6-85"><a href="#cb6-85"></a>    </span>
<span id="cb6-86"><a href="#cb6-86"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/observeEvent">observeEvent</a></span>(input<span class="op">$</span>target_vectors,{</span>
<span id="cb6-87"><a href="#cb6-87"></a>        splitter &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/tstrsplit">strsplit</a></span>(input<span class="op">$</span>target_vectors,<span class="dt">split=</span><span class="st">"_"</span>))</span>
<span id="cb6-88"><a href="#cb6-88"></a>        values<span class="op">$</span>target_terms &lt;-<span class="st"> </span>sl_data_names[<span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(sl_data),</span>
<span id="cb6-89"><a href="#cb6-89"></a>                                                       <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(splitter[<span class="dv">1</span>],<span class="st">"_terms"</span>,<span class="dt">sep=</span><span class="st">""</span>,<span class="dt">collapse=</span><span class="st">''</span>))]</span>
<span id="cb6-90"><a href="#cb6-90"></a>        </span>
<span id="cb6-91"><a href="#cb6-91"></a>    })</span>
<span id="cb6-92"><a href="#cb6-92"></a>    </span>
<span id="cb6-93"><a href="#cb6-93"></a>    <span class="co"># MAIN OBSERVE FUNCTION</span></span>
<span id="cb6-94"><a href="#cb6-94"></a>    </span>
<span id="cb6-95"><a href="#cb6-95"></a>    <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/observe">observe</a></span>({</span>
<span id="cb6-96"><a href="#cb6-96"></a>        </span>
<span id="cb6-97"><a href="#cb6-97"></a>        <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/validate">validate</a></span>(</span>
<span id="cb6-98"><a href="#cb6-98"></a>            <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/validate">need</a></span>(input<span class="op">$</span>search_terms <span class="op">!=</span><span class="st"> ""</span>,<span class="st">"none"</span>)</span>
<span id="cb6-99"><a href="#cb6-99"></a>        )</span>
<span id="cb6-100"><a href="#cb6-100"></a>        </span>
<span id="cb6-101"><a href="#cb6-101"></a>        <span class="co"># get similarities</span></span>
<span id="cb6-102"><a href="#cb6-102"></a>        sim_df &lt;-<span class="st"> </span><span class="kw">get_similarities</span>(input<span class="op">$</span>search_terms,</span>
<span id="cb6-103"><a href="#cb6-103"></a>                                   sl_data[[values<span class="op">$</span>term_choice]],</span>
<span id="cb6-104"><a href="#cb6-104"></a>                                   sl_data[[input<span class="op">$</span>search_vectors]],</span>
<span id="cb6-105"><a href="#cb6-105"></a>                                   sl_data[[input<span class="op">$</span>target_vectors]],</span>
<span id="cb6-106"><a href="#cb6-106"></a>                                   sl_data[[values<span class="op">$</span>target_terms]])</span>
<span id="cb6-107"><a href="#cb6-107"></a>        </span>
<span id="cb6-108"><a href="#cb6-108"></a>        <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/req">req</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(sim_df)) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb6-109"><a href="#cb6-109"></a>        </span>
<span id="cb6-110"><a href="#cb6-110"></a>        <span class="co"># get MDS solution</span></span>
<span id="cb6-111"><a href="#cb6-111"></a>         mds_SS &lt;-<span class="st"> </span><span class="kw">get_mds_fits</span>(<span class="dt">num_items =</span> input<span class="op">$</span>num_items,</span>
<span id="cb6-112"><a href="#cb6-112"></a>                                       <span class="dt">num_clusters =</span> input<span class="op">$</span>num_clusters,</span>
<span id="cb6-113"><a href="#cb6-113"></a>                                       <span class="dt">input_df =</span> sim_df, </span>
<span id="cb6-114"><a href="#cb6-114"></a>                                       <span class="dt">target_vectors =</span> sl_data[[input<span class="op">$</span>target_vectors]],</span>
<span id="cb6-115"><a href="#cb6-115"></a>                                       <span class="dt">target_terms =</span> sl_data[[values<span class="op">$</span>target_terms]])</span>
<span id="cb6-116"><a href="#cb6-116"></a>         </span>
<span id="cb6-117"><a href="#cb6-117"></a>         <span class="co"># output table</span></span>
<span id="cb6-118"><a href="#cb6-118"></a>        </span>
<span id="cb6-119"><a href="#cb6-119"></a>        output<span class="op">$</span>sl_table &lt;-<span class="st"> </span>DT<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DT/topics/dataTableOutput">renderDT</a></span>({</span>
<span id="cb6-120"><a href="#cb6-120"></a>            </span>
<span id="cb6-121"><a href="#cb6-121"></a>            <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(sim_df[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,])</span>
<span id="cb6-122"><a href="#cb6-122"></a>            </span>
<span id="cb6-123"><a href="#cb6-123"></a>        }, <span class="dt">options =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">pageLength=</span><span class="dv">10</span>), <span class="dt">rownames=</span><span class="ot">FALSE</span>,</span>
<span id="cb6-124"><a href="#cb6-124"></a>        <span class="dt">escape=</span><span class="ot">FALSE</span>, <span class="dt">selection =</span> <span class="st">'none'</span>)</span>
<span id="cb6-125"><a href="#cb6-125"></a>        </span>
<span id="cb6-126"><a href="#cb6-126"></a>        <span class="co"># output plot</span></span>
<span id="cb6-127"><a href="#cb6-127"></a>    </span>
<span id="cb6-128"><a href="#cb6-128"></a>        output<span class="op">$</span>sl_plot &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/renderPlot">renderPlot</a></span>({</span>
<span id="cb6-129"><a href="#cb6-129"></a>            </span>
<span id="cb6-130"><a href="#cb6-130"></a>            <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/validate">validate</a></span>(</span>
<span id="cb6-131"><a href="#cb6-131"></a>                <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/validate">need</a></span>(input<span class="op">$</span>search_terms <span class="op">!=</span><span class="st"> ""</span>,<span class="st">"none"</span>),</span>
<span id="cb6-132"><a href="#cb6-132"></a>                <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/validate">need</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(sim_df)) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>,<span class="st">"none"</span>)</span>
<span id="cb6-133"><a href="#cb6-133"></a>            )</span>
<span id="cb6-134"><a href="#cb6-134"></a>            </span>
<span id="cb6-135"><a href="#cb6-135"></a>            <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mds_SS, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span> X, <span class="dt">y=</span> Y,</span>
<span id="cb6-136"><a href="#cb6-136"></a>                                      <span class="dt">color=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(cluster),</span>
<span id="cb6-137"><a href="#cb6-137"></a>                                    <span class="co">#  text=terms,</span></span>
<span id="cb6-138"><a href="#cb6-138"></a>                                      <span class="dt">label=</span>terms))<span class="op">+</span></span>
<span id="cb6-139"><a href="#cb6-139"></a><span class="st">                </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggrepel/topics/geom_text_repel">geom_label_repel</a></span>(<span class="dt">size=</span><span class="dv">4</span>, <span class="dt">color=</span> <span class="st">"black"</span>,</span>
<span id="cb6-140"><a href="#cb6-140"></a>                                 <span class="dt">label.size=</span><span class="dv">0</span>,</span>
<span id="cb6-141"><a href="#cb6-141"></a>                                 <span class="dt">force=</span><span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb6-142"><a href="#cb6-142"></a><span class="st">                </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">alpha=</span>.<span class="dv">75</span>)<span class="op">+</span></span>
<span id="cb6-143"><a href="#cb6-143"></a><span class="st">                </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>()<span class="op">+</span></span>
<span id="cb6-144"><a href="#cb6-144"></a><span class="st">                </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb6-145"><a href="#cb6-145"></a>    </span>
<span id="cb6-146"><a href="#cb6-146"></a>        })</span>
<span id="cb6-147"><a href="#cb6-147"></a>    </span>
<span id="cb6-148"><a href="#cb6-148"></a>    })</span>
<span id="cb6-149"><a href="#cb6-149"></a>}</span>
<span id="cb6-150"><a href="#cb6-150"></a></span>
<span id="cb6-151"><a href="#cb6-151"></a><span class="co"># Run the application </span></span>
<span id="cb6-152"><a href="#cb6-152"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#alice-in-wonderland">Alice in wonderland</a></li>
      <li>
<a href="#alice-overview">Alice overview</a><ul class="nav nav-pills nav-stacked">
<li><a href="#current-limitations">Current limitations</a></li>
      <li><a href="#corpus_constructor">corpus_constructor</a></li>
      <li><a href="#shiny-app-r">Shiny app.r</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Matt Crump.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
